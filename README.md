Ported from https://github.com/vmware/splinterdb/pull/583
